import this
from app.extensions import db
from app.models.beasiswa_model import UktModel as ukt


class CountUkt():
    def total_data():
        sql_total_data = ukt.query.count()

        sql_terima = ukt.query.filter(ukt.status_layak == 'terima').count()
        sql_tidak = ukt.query.filter(ukt.status_layak == 'tidak').count()

        return {
            'total_data': sql_total_data,
            'terima': sql_terima,
            'tidak': sql_tidak,
        }

    def total_class():
        sql_terima = ukt.query.filter(ukt.status_layak == 'terima').count(
        ) / CountUkt.total_data().get('total_data')
        sql_tidak = ukt.query.filter(ukt.status_layak == 'tidak').count(
        ) / CountUkt.total_data().get('total_data')

        return {
            'p_class_terima': round(sql_terima, 2),
            'p_class_tidak': round(sql_tidak, 2),
        }

    def status_mahasiswa():
        # aktif terima
        sql_aktif_terima = ukt.query.filter(
            ukt.status_mhs == 'aktif', ukt.status_layak == 'terima').count() / CountUkt.total_data().get('terima')
        # aktif tidak
        sql_aktif_tidak = ukt.query.filter(
            ukt.status_mhs == 'aktif', ukt.status_layak == 'tidak').count() / CountUkt.total_data().get('tidak')

        # cuti terima
        sql_cuti_teirma = ukt.query.filter(
            ukt.status_mhs == 'cuti', ukt.status_layak == 'terima').count() / CountUkt.total_data().get('terima')
        # cuti tidak
        sql_cuti_tidak = ukt.query.filter(
            ukt.status_mhs == 'cuti', ukt.status_layak == 'tidak').count() / CountUkt.total_data().get('tidak')

        return {
            'aktif_terima': round(sql_aktif_terima, 2),
            'aktif_tidak': round(sql_aktif_tidak, 2),
            'cuti_terima': round(sql_cuti_teirma, 2),
            'cuti_tidak': round(sql_cuti_tidak, 2),
        }

    def status_pkh():
        # pkh terima
        sql_pkh_terima = ukt.query.filter(
            ukt.status_pkh == 'PKH', ukt.status_layak == 'terima').count() / CountUkt.total_data().get('terima')
        # pkh tidak
        sql_pkh_tidak = ukt.query.filter(
            ukt.status_pkh == 'PKH', ukt.status_layak == 'tidak').count() / CountUkt.total_data().get('tidak')

        # non pkh terima
        sql_non_phk_terima = ukt.query.filter(
            ukt.status_pkh == 'Non-PKH', ukt.status_layak == 'terima').count() / CountUkt.total_data().get('terima')
        # non pkh tidak
        sql_non_phk_tidak = ukt.query.filter(
            ukt.status_pkh == 'Non-PKH', ukt.status_layak == 'tidak').count() / CountUkt.total_data().get('tidak')

        return {
            'pkh_terima': round(sql_pkh_terima, 2),
            'pkh_tidak': round(sql_pkh_tidak, 2),
            'non_pkh_terima': round(sql_non_phk_terima, 2),
            'non_pkh_tidak': round(sql_non_phk_tidak, 2),
        }

    def prodi():
        # informatika
        sql_informatika_terima = ukt.query.filter(
            ukt.prodi == '4', ukt.status_layak == 'terima').count()
        sql_informatika_tidak = ukt.query.filter(
            ukt.prodi == '4', ukt.status_layak == 'tidak').count()
        # industri
        sql_industri_terima = ukt.query.filter(
            ukt.prodi == '1', ukt.status_layak == 'terima').count()
        sql_industri_tidak = ukt.query.filter(
            ukt.prodi == '1', ukt.status_layak == 'tidak').count()
        # mesin
        sql_mesin_terima = ukt.query.filter(
            ukt.prodi == '2', ukt.status_layak == 'terima').count()
        sql_mesin_tidak = ukt.query.filter(
            ukt.prodi == '2', ukt.status_layak == 'tidak').count()
        # elektro
        sql_elektro_terima = ukt.query.filter(
            ukt.prodi == '3', ukt.status_layak == 'terima').count()
        sql_elektro_tidak = ukt.query.filter(
            ukt.prodi == '3', ukt.status_layak == 'tidak').count()
        # sipil
        sql_sipil_terima = ukt.query.filter(
            ukt.prodi == '5', ukt.status_layak == 'terima').count()
        sql_sipil_tidak = ukt.query.filter(
            ukt.prodi == '5', ukt.status_layak == 'tidak').count()

        return {
            'informatika_terima': sql_informatika_terima,
            'informatika_tidak': sql_informatika_tidak,
            'industri_terima': sql_industri_terima,
            'industri_tidak': sql_industri_tidak,
            'mesin_terima': sql_mesin_terima,
            'mesin_tidak': sql_mesin_tidak,
            'elektro_terima': sql_elektro_terima,
            'elektro_tidak': sql_elektro_tidak,
            'sipil_terima': sql_sipil_terima,
            'sipil_tidak': sql_sipil_tidak,
        }
